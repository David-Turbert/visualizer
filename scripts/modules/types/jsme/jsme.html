
<!doctype html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<title></title>
		<script type="text/javascript" language="javascript" src="./libs/jsme/jsme.nocache.js"></script>
	</head>
	<body style="margin: 0; padding: 0;">

	<div id="appletContainer"></div>

	<script type="text/javascript">

		this.setController = function(controller) {
			this.controller = controller;
		}

		this.setView = function(view) {
			this.view = view;
		}

		this.setMolFile = function(mol) {
			jsmeApplet.readMolFile(mol);
		}

		this.setSize = function(w, h) {
			var width=w+"px";
			var height=h+"px";
			jsmeApplet.setSize(width, height);
			jsmeApplet.repaint();
		}

		this.setHighlight = function(atoms, onOff) {
			var molIndex=1;
			if(!onOff) {
				jsmeApplet.resetAtomColors(1);	
			} else {
				var highlight=[];
				for (var i=0; i<atoms.length; i++) {
					highlight.push(atoms[i]);
					highlight.push(3);
				}
				jsmeApplet.setAtomBackgroundColors(molIndex,highlight.join(","))	
			}
		}
		
		this.clearHighlight = function(molIndex, atomsIndex) {
			jsmeApplet.resetAtomColors(molIndex);
		}

		function jsmeOnLoad() {
			var w = window.innerWidth;
			var h = window.innerHeight;
			
			var __self = window;
			jsmeApplet = new JSApplet.JSME("appletContainer", w + "px", h + "px");

			jsmeApplet.options(this.view.getPrefs());

			jsmeApplet.setNotifyStructuralChangeJSfunction('(function() {  var mol = this.jsmeApplet.molFile(); var smiles = this.jsmeApplet.smiles(); this.controller.onChange(mol, smiles); })');

			// The notifyAtomHighLightJSfunction will receive two arguments: the molecule index and the atom index, both start at 1
			jsmeApplet.setNotifyAtomHighLightChangeJSfunction('(function(mol,atom,status) {this.view._doHighlight(mol,atom);})');


			this.view.onReady.resolve();

		}
	</script>


	</body>
</html>